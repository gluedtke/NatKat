---
title: "Bayes' Rule"
author: "Gwendolin Lüdtke, Sina Spors"
date: "20 November 2018"
output:
  html_document:
    highlight: textmate
    code_folding: show
    theme: spacelab #cerulean, journal, flatly, darkly, readable, spacelab, united, cosmo, lumen, paper, sandstone,                       simplex, and yet
    toc: true #add table of contents, possible to modify toc_depth: 1-3
    toc_float: #floating table of contents will always be visible even when the document is scrolled
      collapsed: false #controls whether the TOC appears with only the top-level (e.g., H2) headers. If collapsed                            initially, the TOC is automatically expanded inline when necessary
      smooth_scroll: true #controls whether page scrolls are animated when TOC items are navigated to via mouse                                 clicks
      
#Alternative: html_notebook
---

<style>
body {
text-align: justify} 
</style>


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


*Assume that lightning strike causes wildfires with a probability of 1/1000. You observe a wildfire and an eyewitness claims that it was lit by lightning. What is the probability that this is correct, knowing that eyewitness reports are reliable 80% of the time?*

##Basics

We are going to use the **Bayes' Rule** in order to solve this problem. The Bayes Rule, *that deals with conditional probabilities* is defined as follows: $$p(\kappa|D)=\frac{p(D|\kappa) p(\kappa)}{p(D)}$$ where D are the observed data and  $\kappa$ are the things that we can learn from observed data.

In R the Bayes' Rule can look as follows:


```{r, eval = FALSE}
post <- likeli * prior / evid

```


## Assign the given values to variables of the Bayes' Rule

The following approach was **adopted from/by** [Mages Blog](https://magesblog.com/post/2014-07-29-hit-and-run-think-bayes/).

First of all, the **given values** are assign to the **variables** in the formula:

* D = witness said the wildfire was caused by lightning (since it is the only observation that we have)
* $\kappa$ = wildfire caused by lightning

From the question stated above we know that:

* $p(wildfire\:caused\:by\:lightning)=1/1000$
* $p(eyewitness\:is\:right)=80/100$

It follows from the foregoing that:

```{r}
#p(k) 
prior <- 1/1000

#p(D|k) = p (witness said the wildfire was caused by lightning|wildfire caused by lightning)
likeli <- 80/100
```

Now we are looking for the probability that an eyewitness **actually** observed a wildfire that was caused by a lightning.

##Missing variable

However, in order to find this probability, we need to define $p(D)$ or $P(witness\:said\:the\:wildfire\:was\:caused\:by\:lightning)$.

When would the witness say that the wildfire was caused by lightning? 
**Either**, when the fire was caused by a lightning and so the eyewitness is right 
**or** when the fire was not caused by a lightning and the witness is incorrect.



**Here, we can use the law of total probability:**

$$p(D) = p(D|\kappa)p(\kappa)+p(D|-\kappa)p(-\kappa)$$

where ```-``` indicates the complementary probability.

In R we can write this as:

```{r}

evidence <- (likeli*prior) + ((1-likeli)*(1-prior))
```

## Final Calculation

```{r}
post <- likeli * prior / evidence
cat("Post: ", post) 
```

Thus, even if the witness states the wildfire was caused by lightning, the probability of being true is **0,399 %**






